<Info>Required SDK version: ^v4.70.0</Info>

Use the `usePrepareSwap` hook to request swap quotes and the `useSignAndSendPreparedCalls` hook to execute token swaps on the same chain.

**Prerequisites**

- [Smart Wallets installed and configured in your project](/wallets/react/getting-started/setup)
- An [authenticated user](/wallets/authentication/overview)
- Tokens in your smart account to swap

<CodeBlocks>

```tsx title="swapTokens.tsx"
import {
  useSmartAccountClient,
  usePrepareSwap,
  useSignAndSendPreparedCalls,
  useWaitForCallsStatus,
  useUser,
} from "@account-kit/react";

// Token addresses on Arbitrum
const TOKENS = {
  NATIVE: "0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEee", // ETH
  USDC: "0xaf88d065e77c8cC2239327C5EDb3A432268e5831",
} as const;

export default function SwapTokens() {
  const user = useUser();
  const { client } = useSmartAccountClient({
    accountParams: { mode: "7702" },
  });

  const { prepareSwapAsync, isPreparingSwap } = usePrepareSwap({
    client,
  });

  const {
    signAndSendPreparedCallsAsync,
    isSigningAndSendingPreparedCalls,
    signAndSendPreparedCallsResult,
  } = useSignAndSendPreparedCalls({ client });

  const {
    data: statusResult,
    isLoading: isWaitingForConfirmation,
    error,
  } = useWaitForCallsStatus({
    client,
    id: signAndSendPreparedCallsResult?.preparedCallIds[0],
  });

  const handleSwap = async () => {
    if (!client?.account.address) {
      throw new Error("No account connected");
    }

    try {
      // Step 1: Request swap quote
      const result = await prepareSwapAsync({
        from: client.account.address,
        fromToken: TOKENS.NATIVE,
        toToken: TOKENS.USDC,
        fromAmount: "0x5af3107a4000", // 0.0001 ETH
        // postCalls: [{
        //   to: "0x...",
        //   data: "0x...",
        //   value: "0x0"
        // }], // Optional: batch additional calls after the swap
      });

      const { quote, ...calls } = result;
      console.log("Swap quote:", quote);

      // Ensure we have user operation calls
      if (calls.rawCalls) {
        throw new Error("Expected user operation calls");
      }

      // Step 2: Sign and send the prepared calls
      const callIds = await signAndSendPreparedCallsAsync(calls);

      console.log("Transaction sent");
      console.log("Call ID:", callIds?.preparedCallIds[0]);
    } catch (error) {
      console.error("Swap failed:", error);
    }
  };

  if (!user) {
    return <div>Please log in to use swap functionality</div>;
  }

  return (
    <div>
      <button onClick={handleSwap} disabled={!client}>
        {isPreparingSwap
          ? "Requesting quote..."
          : isSigningAndSendingPreparedCalls
            ? "Signing and sending..."
            : "Swap ETH to USDC"}
      </button>

      {signAndSendPreparedCallsResult && (
        <p>
          {isWaitingForConfirmation
            ? "Waiting for confirmation..."
            : error
              ? `Error: ${error}`
              : statusResult?.statusCode === 200
                ? "Swap confirmed!"
                : `Status: ${statusResult?.statusCode}`}
        </p>
      )}
    </div>
  );
}
```

</CodeBlocks>

## How it works

1. **Request quote**: `usePrepareSwap` requests a swap quote and prepares the transaction calls
2. **Destructure result**: Extract `quote` for display and `calls` for signing
3. **Sign and send**: `useSignAndSendPreparedCalls` signs and submits the transaction
4. **Track status**: `useWaitForCallsStatus` monitors the transaction until confirmation

The quote includes the minimum amount you'll receive and the expiry time for the quote.

## Swap options

You can specify either an exact input amount or a minimum output amount:

```tsx
// Mode 1: Swap exact input amount
await prepareSwapAsync({
  from: address,
  fromToken: "0x...",
  toToken: "0x...",
  fromAmount: "0x2710", // Swap exactly 0.01 USDC (10000 in hex, 6 decimals)
});

// Mode 2: Get minimum output amount
await prepareSwapAsync({
  from: address,
  fromToken: "0x...",
  toToken: "0x...",
  minimumToAmount: "0x5AF3107A4000", // Get at least 0.0001 ETH (18 decimals)
});
```
