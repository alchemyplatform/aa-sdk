See the [`wallet_prepareCalls` API
reference](/docs/wallets/api/smart-wallets/wallet-api-endpoints/wallet-api-endpoints/wallet-prepare-calls)
for full descriptions of the parameters used in the following example.

<Steps>
  <Step title="(If Needed) Request Account">
    If the user does not yet have a smart account, you must create one.
```bash twoslash
  ACCOUNT_ADDRESS=$(curl --request POST \
  --url https://api.g.alchemy.com/v2/$ALCHEMY_API_KEY \
  --header 'accept: application/json' \
  --data '
{
  "id": 1,
  "jsonrpc": "2.0",
  "method": "wallet_requestAccount",
  "params": [
    { 
      "signerAddress": "'$SIGNER_ADDRESS'",
      "includeCounterfactualInfo": true 
    }
  ]
}
' | jq -r '.result.accountAddress')
```
  </Step>
  <Step title="Prepare Calls">
    Prepare calls using the `paymasterService` capability.
```bash twoslash
curl --request POST \
  --url https://api.g.alchemy.com/v2/$ALCHEMY_API_KEY \
  --header 'accept: application/json' \
  --data '
{
  "id": 1,
  "jsonrpc": "2.0",
  "method": "wallet_prepareCalls",
  "params": [
    {
      "capabilities": {
        "paymasterService": {
          "policyId": "'$ALCHEMY_POLICY_ID'",
          "erc20": {
            "tokenAddress": "'$GAS_TOKEN'",
            "postOpSettings": {
              "autoApprove": {
                "below": "'$APPROVE_BELOW'",
                "amount": "'$APPROVE_AMOUNT'"
              }
            }
          }
        }
      },
      "calls": [
        {
          "to": "0x0000000000000000000000000000000000000000"
        }
      ],
      "from": "'$ACCOUNT_ADDRESS'",
      "chainId": "'$CHAIN_ID'"
    }
  ]
}'
```
  </Step>
  <Step title="Sign & Send">
    Sign the returned signature request and send using `wallet_sendPreparedCalls`.
  </Step>
</Steps>
