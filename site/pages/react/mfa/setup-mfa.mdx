---
title: Setting Up Multi-Factor Authentication
description: How to set up additional security with authenticator apps in your React application
---

# Setting Up Multi-Factor Authentication (Authenticator Apps)

With Account Kit, multi-factor authentication (MFA) uses authenticator apps—like Google Authenticator, Authy, or Microsoft Authenticator—to generate a Time-based One-Time Password (TOTP).

By requiring both a user’s primary login (e.g., email OTP, magic link, or social login) and a TOTP from their authenticator app, your application gains an extra layer of security.

:::tip
Multi-factor authentication is currently only supported when authenticating with Email OTP, Email Magic Link, or Social Login.
:::

## Overview

Multi-factor authentication adds an extra layer of security by requiring users to verify their identity using multiple methods. With Account Kit, users can use authenticator apps (like Google Authenticator, Authy, or Microsoft Authenticator) as their second security factor.

## Implementation

To implement authenticator app verification in your React application, you'll use the `useMFA` hook from Account Kit.

### Step 1: Checking if Multi-Factor Authentication is Available

First, check if the user is logged and able to edit their MFA settings:

```tsx twoslash
import React from "react";
import { useMFA } from "@account-kit/react";

// Inside your component
const { isMfaAvailable } = useMFA();

// Only show MFA setup options if available
if (isMfaAvailable) {
  // Render MFA setup UI
} else {
  // User needs to authenticate first
}
```

### Step 2: Setting Up an Authenticator App

In this step, we generate a QR code (TOTP seed) for the user to scan. Most authenticator apps (Google Authenticator, Authy, 1Password, etc.) can scan this QR code to generate 6-digit time-based codes.

```tsx twoslash
import React, { useState } from "react";
import { QRCodeSVG } from "qrcode.react";
import { useMFA } from "@account-kit/react";

function AuthenticatorSetupComponent() {
  const { addMFA } = useMFA();
  const [qrCodeUrl, setQrCodeUrl] = useState("");
  const [factorId, setFactorId] = useState("");

  const handleSetupAuthenticator = () => {
    addMFA(
      {
        multiFactorType: "totp", // Technical name for authenticator apps
      },
      {
        onSuccess: (result) => {
          // Store the QR code URL and factor ID
          setQrCodeUrl(result.multiFactorTotpUrl);
          setFactorId(result.multiFactorId);
        },
        onError: (error) => {
          console.error("Failed to set up authenticator app:", error);
        },
      }
    );
  };

  return (
    <div>
      <button onClick={handleSetupAuthenticator}>
        Set Up Authenticator App
      </button>

      {qrCodeUrl && (
        <div className="qr-container">
          <h3>Scan this QR code with your authenticator app</h3>
          <QRCodeSVG value={qrCodeUrl} size={200} />
          <p>
            After scanning, enter the 6-digit code from your authenticator app
            to complete setup.
          </p>
        </div>
      )}
    </div>
  );
}
```

This QR code contains the information needed for apps like Google Authenticator or Authy. Once scanned, the app will generate 6-digit codes that users can use as their second verification step.

### Step 3: Confirming the Authenticator App Setup

After the user scans the QR code, they need to prove it worked by entering a code:

```tsx twoslash
import React from "react";
import { useMFA } from "@account-kit/react";

// Inside your component
const { verifyMFA } = useMFA();

const handleVerifyAuthenticator = (code: string, multiFactorId: string) => {
  verifyMFA(
    {
      multiFactorId,
      multiFactorCode: code, // "multiFactorCode" here is the TOTP code from the user's authenticator app
    },
    {
      onSuccess: () => {
        // Authenticator setup successful
      },
      onError: (error) => {
        // Handle error
      },
    }
  );
};
```

### Step 4: Managing Authenticator Apps

You can retrieve and remove authenticator app–based MFA from a user's account by using the `useMFA` hook. Each verification method (also called a “factor”) is identified by a unique `multiFactorId`. For example, a TOTP-based authenticator app is one factor.

```tsx twoslash
import React from "react";
import { useMFA } from "@account-kit/react";

// Inside your component
const { getMFAFactors, removeMFA } = useMFA();

// Fetch all MFA verification methods (factors) for the current user
const fetchVerificationMethods = () => {
  getMFAFactors(undefined, {
    onSuccess: (factors) => {
      // factors.multiFactors is an array of verification methods,
      // each represented by a unique multiFactorId.
      console.log("User's MFA factors:", factors.multiFactors);
    },
    onError: (error) => {
      // Handle error
    },
  });
};

// Remove a TOTP authenticator app by its multiFactorId
const handleRemoveAuthenticator = (multiFactorId: string) => {
  removeMFA(
    { multiFactorIds: [multiFactorId] },
    {
      onSuccess: () => {
        console.log("Authenticator removed successfully!");
      },
      onError: (error) => {
        // Handle error
      },
    }
  );
};
```

## Next Steps

After setting up an authenticator app, users will need to provide both their primary authentication method and a 6-digit code when signing in:

### Using Pre-built UI Components

If you're using the [pre-built UI components](/react/ui-components), the MFA verification process is handled automatically:

- The authentication flow will detect when a user has MFA enabled
- Users will be prompted for their authenticator app code after providing their primary credentials
- No additional code is required from you

### Using Custom UI with Hooks

If you're implementing [custom UI with hooks](/react/react-hooks), you'll need to update your authentication code to handle the MFA verification step:

- [Email OTP with Multi-Factor Authentication](/react/mfa/email-otp) - See how to implement the two-step verification
- [Email Magic Link with Multi-Factor Authentication](/react/mfa/email-magic-link) - Learn how to handle magic links with MFA
- [Social Login with Multi-Factor Authentication](/react/mfa/social-login) - Social login with MFA is handled in the OAuth callback

For custom UI implementations, make sure your authentication logic checks for the MFA requirement and provides UI for users to enter their authenticator app code.
