---
title: Email OTP with Multi-Factor Authentication
description: How to authenticate using Email OTP when MFA is enabled
---

# Email OTP with Multi-Factor Authentication

This guide shows you how to implement Email OTP authentication when a user has multi-factor authentication (MFA) enabled.

## Overview

When MFA is enabled, the authentication process requires two steps:

1. Verify the user's email with a one-time password
2. Verify the 6-digit code (TOTP) from their authenticator app

## Implementation

### Step 1: Start Email OTP Authentication

First, initiate the email OTP authentication process:

```tsx twoslash
import { useAuthenticate } from "@account-kit/react";

// Inside your component
const { authenticateAsync } = useAuthenticate();

const handleSendCode = async (email: string) => {
  try {
    await authenticateAsync({
      type: "email",
      emailMode: "otp",
      email,
    });
    // Success - now show the OTP input form
  } catch (error) {
    // Handle error
  }
};
```

### Step 2: Check if an Authenticator App is Required

After receiving the email OTP, check if MFA is required:

```tsx twoslash
import { useSigner } from "@account-kit/react";

// Inside your component
const signer = useSigner();

const checkMfaStatus = () => {
  const { mfaRequired, mfaFactorId } = signer?.getMfaStatus() || {};
  return { mfaRequired, mfaFactorId };
};
```

### Step 3: Complete Authentication

If MFA is required, you'll need both the email OTP and the TOTP code:

```tsx twoslash
import { useAuthenticate } from "@account-kit/react";

// Inside your component
const { authenticateAsync } = useAuthenticate();

const handleVerify = async (
  emailOtp: string,
  mfaFactorId?: string,
  totpCode?: string
) => {
  try {
    if (mfaFactorId && totpCode) {
      // MFA is required
      await authenticateAsync({
        type: "otp",
        otpCode: emailOtp,
        multiFactors: [
          {
            multiFactorId: mfaFactorId,
            multiFactorCode: totpCode,
          },
        ],
      });
    } else {
      // No MFA required
      await authenticateAsync({
        type: "otp",
        otpCode: emailOtp,
      });
    }
    // Authentication successful!
  } catch (error) {
    // Handle error
  }
};
```

## Next Steps

- [Set up MFA for your users](/react/mfa/setup-mfa)
- [Email Magic Link with MFA](/react/mfa/email-magic-link)
